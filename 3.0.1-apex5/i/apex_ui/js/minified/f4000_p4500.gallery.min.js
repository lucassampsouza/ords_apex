window.componentGallery={},function(a,b,c,d,e){"use strict";function f(a){var b,c=a.split(":"),d=x[w[c[0]]];if(d&&(b=d[c[1]]),!b)throw"Invalid component data key";return b}function g(a,c,d){var e,f=b.isPageReadOnly();e=y[d.type],f||(e+=" is-draggable"),a.markup("<li").attr("class",e).optionalAttr("aria-grabbed",f?null:"false").attr("data-component",d.type+":"+c).markup("><span class='a-Icon ").attr(d.iconClass).markup("'></span><span class='a-Gallery-componentName'>").content(d.title).markup("</span></li>")}function h(a,b,c){var f=d.htmlBuilder();return b=b||"",/^\s</.test(b)||(b="<p>"+b+"</p>"),f.markup("<span class='tt-title'>").content(a).markup("</span>").markup(b),c||f.markup("<p>").content(e.formatMessageNoEscape("PD.GAL.NOT_SUPPORTED",u)).markup("</p>"),f.toString()}function i(){var a,d,f,g,i,j=b.getComponentType(b.COMP_TYPE.REGION).pluginType.plugins;for(a in j)if(j.hasOwnProperty(a)){if(d=j[a],d.isLegacy||"NATIVE_DATA_UPLOAD_COLUMN_MAPPING"===d.name)continue;g=-1!==c.inArray(t,d.uiTypes),i=b.getTheme().defaultTemplates["NATIVE_IR"===a?"ir":"region"],f={type:o,iconClass:window.pageDesigner.getComponentIconClass(o,a),title:g?d.title:e.formatMessage("PD.UNSUPPORTED",d.title),isSupported:g,tooltip:h(d.title,d.helpText,g),values:[{id:b.PROP.REGION_TYPE,value:a},{id:b.PROP.REGION_TEMPLATE,value:i}]},x.regions.push(f)}}function j(){var a,d,f,g,i=b.getComponentType(b.COMP_TYPE.PAGE_ITEM).pluginType.plugins;for(a in i)if(i.hasOwnProperty(a)){if(d=i[a],d.isLegacy)continue;g=-1!==c.inArray(t,d.uiTypes),f={type:p,iconClass:window.pageDesigner.getComponentIconClass(p,a),title:g?d.title:e.formatMessage("PD.UNSUPPORTED",d.title),isSupported:g,tooltip:h(d.title,d.helpText,g),values:[{id:b.PROP.ITEM_TYPE,value:a}]},x.items.push(f)}}function k(){function a(a,c,d){f={type:q,iconClass:window.pageDesigner.getComponentIconClass(q,"Y"===d?"hot":"normal"),title:a,isSupported:!0,tooltip:h(a,"",!0),values:[{id:b.PROP.BUTTON_TEMPLATE,value:c},{id:b.PROP.BUTTON_IS_HOT,value:d}]},x.buttons.push(f)}var c,d,f,g=b.getButtonTemplates();for(c in g)g.hasOwnProperty(c)&&(d=g[c],a(d.name,c,"N"),d.hasHotTemplate&&a(e.formatMessage("PD.GAL.HOT_BTN",d.name),c,"Y"))}function l(){var a=b.getComponents(b.COMP_TYPE.PAGE)[0];t=a._uiType,u=a.getProperty(b.PROP.USER_INTERFACE).getDisplayValue(),i(),j(),k(),c.each(["regions","items","buttons"],function(a,b){x[b].sort(function(a,b){return a.title.localeCompare(b.title)})}),m()}function m(){var a=c("#glv"),e=b.isPageReadOnly(),h=d.htmlBuilder();c.each(["regions","items","buttons"],function(b,d){var i,j,k=x[d],l=c("#cg-"+d+" ul").first();for(h.clear(),i=0;i<k.length;i++)j=k[i],(j.isSupported||v)&&g(h,i,j);l.html(h.toString()).iconList("refresh"),e||c("#cg-"+d+" li").draggable({addClasses:!1,appendTo:"#glv-viewport",cursor2:"default",cursorAt:{left:2,top:2},delay:10,distance:5,opacity:.9,revert:!1,helper:function(){var b=c(this),d=b.attr("data-component"),e=f(d);return a.gridlayout("makeHelper",e.type,e.iconClass,e.title,d)},connectToGridlayout:"#glv",containment:"document",zIndex:1e3,start:function(){0!==c("#editor_tabs").tabs("option","active")&&c("#editor_tabs").tabs("option","active",0),apex.tooltipManager.disableTooltips()},stop:function(){apex.tooltipManager.enableTooltips()}})})}function n(){c.each(["regions","items","buttons"],function(a,b){var d=c("#cg-"+b+" ul").first();x[b]=[],d.empty().iconList("refresh")})}var o="region",p="item",q="button",r="GAL_SHOW_UNSUP",s="GAL_CUR_TAB",t=null,u="",v=!1,w={region:"regions",item:"items",button:"buttons"},x={regions:[],items:[],buttons:[]},y={region:"a-Gallery-region",item:"a-Gallery-pageItem",button:"a-Gallery-button"};a.getComponentData=f,c(document).ready(function(){var a,d=!1;v="Y"===window.pageDesigner.getPreference(r);var e={menubar:!1,items:[{id:"addTo",type:"subMenu",disabled:!0,labelKey:"PD.GAL.MI.ADD2",menu:{items:[]}},{type:"toggle",labelKey:"PD.GAL.MI.SHOW_UNSUP",get:function(){return v},set:function(a){v=a,m(),window.pageDesigner.savePreference(r,v?"Y":"N")}}],beforeOpen:function(a,d){var e,g,h,i,j=c("#glv"),k=d.menuElement.menu("find","addTo"),l=d.selection;1!==l.length||b.isPageReadOnly()?k.menu.items=[]:(e=l.eq(0),i=e.attr("data-component"),g=f(i),h=function(){window.pageDesigner.glvMenuAddAction.call(this,i)},k.menu.items=window.pageDesigner.glvMakeTargetMenu(j.gridlayout("getDropTargets",g.type,"add"),h)),k.disabled=0===k.menu.items.length}};c("#cg-regions ul, #cg-items ul, #cg-buttons ul").addClass("a-Gallery").each(function(){c(this).iconList({multiple:!1,contextMenu:e,contextMenuId:"galleryMenu-"+c(this).parent().parent()[0].id})}).tooltip({items:"li",show:apex.tooltipManager.defaultShowOption(),position:{my:"left-20 top-20",at:"right bottom",collision:"flipfit"},content:function(){var a=f(c(this).attr("data-component"));return a.tooltip}}),c("#gallery-tabs").on("tabsactivate",function(a,b){c("#galleryMenuBtn").attr("data-menu","galleryMenu-"+b.newPanel[0].id),d||window.pageDesigner.savePreference(s,b.newTab.parent().children().index(b.newTab[0])),d=!1}),c("#galleryMenuBtn").attr("data-menu","galleryMenu-cg-regions"),a=parseInt(window.pageDesigner.getPreference(s),10),!isNaN(a)&&a>0&&setTimeout(function(){d=!0,c("#gallery-tabs").tabs("option","active",a)},10),c("#gallery-tabs .u-ScrollingViewport.resize").resize(function(){c(this).children(".a-IconList").resize()})}),c(document).on("modelReady",function(){l()}),c(document).on("modelCleared",function(){n()})}(window.componentGallery,pe,apex.jQuery,apex.util,apex.lang);