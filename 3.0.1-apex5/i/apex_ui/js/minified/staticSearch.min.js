var staticSearch=function(){function a(a){for(key in a)if(key in q&&key in a._bits){var b=a._bits[key];b.sort(function(a,b){return a.replaceIndex<b.replaceIndex?-1:a.replaceIndex>b.replaceIndex?1:0});for(var c="",d=0,e=0;e<b.length;e++){var f=b[e].replaceIndex;c+=a[key].slice(d,f)+b[e].html,d=f+b[e].length}c+=a[key].slice(d),a[key]=c}}function b(a,b){for(var c in a)if(""!=a[c])if(b instanceof Array){if(-1==b.indexOf(a[c]))return!1}else if(b.toLowerCase()!=a[c])return!1;return!0}function c(a){for(var b=[],c=0;c<a.length;c++)-1===b.indexOf(a[c])&&b.push(a[c]);return b}function d(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c].toLowerCase());return b}function e(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}function f(b,c){var d="",e=0;c||b.sort(function(a,b){return a.priority<b.priority?1:a.priority>b.priority?-1:0});for(var f=0,g=b.length;g>f;f++){var h=b[f].displayItem;if(a(h),d+=u(h),e++,e>M)return d}return d}function g(a){for(var b=!1,c=0,d=a.length;d>c;c++)a[c].length>2&&(b=!0);return b}function h(a){G();var h=c(a.split(/\s+/g)),i=d(h),j=!x&&1==h.length&&""==h[0];if(!g(i)&&!j)return void n.html("<em>"+apex.lang.getMessage("STATICSEARCH.MINIMUM_LENGTH")+"</em>");for(var k=r.length,l=D(h,i,"tag"),m=D(h,i,"category"),o=[];k>=1;){k--;var p=r[k],q=E(p),s=0;if(b(l,p._split_Tags)&&(e(l)||s++,b(m,p.Category))){e(m)||s++;var t={};if(j)s=1;else{for(var u in p)B(q,u,i,t);for(var v in t)s+=t[v]}s>0&&o.push({priority:s,displayItem:q})}}var w=f(o,j);""==w&&(w="<em style='padding-top:10px;'>"+apex.lang.getMessage("STATICSEARCH.NO_RESULTS_FOUND")+"</em>"),H(),n.html(w)}function i(a){var b=$(window).scrollTop(),c=location.hash;location.hash="#"+a.replace(/\s+/g," ").trim().split(" ").join("+"),c==location.hash&&H(),$(window).scrollTop(b)}function j(){return location.hash.substr(1).replace(/\s+/g," ").split("+").join(" ").trim()}function k(){var a=m.val().trim();a!=C&&G(),void 0!=l&&clearTimeout(l),l=setTimeout(function(){o=!0,i(m.val())},400)}"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){var b=this.length>>>0,c=Number(arguments[1])||0;for(c=0>c?Math.ceil(c):Math.floor(c),0>c&&(c+=b);b>c;c++)if(c in this&&this[c]===a)return c;return-1});var l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=function(a,b,c,d){var e=jQuery.extend({},{mapping:{},filterEmpty:!0,limit:5,onEmptySearch:function(){},onActiveSearch:function(){},getSearchResultAsHtml:function(a){return K(a,w)},template:"PASS IN A TEMPLATE HERE"},d);M=e.limit,x=e.filterEmpty,y=[],v=[],q={};for(key in e.mapping)q[key]=e.mapping[key].priority,e.mapping.html&&y.push(key),e.mapping.tag&&v.push(key);t=e.onActiveSearch,s=e.onEmptySearch,u=e.getSearchResultAsHtml,w=e.template,m=$(a),m.on("keydown",function(a){k();var b=a.keyCode||a.which;13===b&&a.preventDefault()}),$(window).on("hashchange",function(){I()}),n=$(b),m.focus(),r=c,L(),J(e.tagMapping),p=$('<button type="button" class="ls-Search-clear" id="clear_static_search_field" value="Clear Search" title="Clear Search"></button>'),p.click(function(){location.hash="#",p.removeClass("is-enabled"),I()}),m.after(p),x||""!=location.hash||(C="asfddaffd",location.hash="#"),I()},A=!0,B=function(a,b,c,d){if(!(b in a&&b in q&&0!=b.indexOf("_")))return 0;if(1==c.length&&""==c[0])return 1;if(0==c.length)return 0;var e=a[b].toLowerCase();-1!=y.indexOf(b)&&(e=a["_"+b+"_HTML"]);for(var f=[],g=0;g<c.length;g++)for(var h=c[g],i=e.indexOf(h);-1!=i;){for(var j=c[g].length,k=a[b].slice(i,i+j),l="",m=0;j>m;m++)l+=" ";e=e.slice(0,i)+l+e.slice(i+j),f.push({replaceIndex:i,length:j,html:"<span class='u-textHighlight'>"+k+"</span>"}),g in d||(d[g]=q[b]),i=e.indexOf(h)}a._bits[b]=f},C="",D=function(a,b,c){for(var d={},e=0;e<a.length;e++)0==a[e].indexOf(c+":")&&(d[e]=a[e].replace(c+":","").replace("+"," ").toLowerCase());for(var f in d)b.splice(f,1),a.splice(f,1);return d},E=function(a){var b={};for(key in a)b[key]=a[key];return b._bits={},b},F=!1,G=function(){F||(F=!0,n.css("opacity",.5))},H=function(){F&&(F=!1,n.css("opacity",1))},I=function(){new Date;o||m.val(j()),o=!1,A&&(A=!1);var a=m.val().trim();if(""==a){if(s(),p.removeClass("is-enabled"),x)return void(C="")}else p.addClass("is-enabled"),t();a!=C&&(C=a,h(a))},J=function(){for(var a=v.length,b=0;a>b;b++)for(var c=v[b],d="_split_"+c,e=r.length-1;e>=0;){r[e][d]=r[e][c].split(",");for(var f=r[e][d].length,g=0;f>g;g++)r[e][d][g]=r[e][d][g].trim().split(" ").join("_").toLowerCase();e--}},K=function(a,b){void 0==b&&(b=w);for(var c in a){var d="#%"+c+"#%";-1!=b.indexOf(d)&&(b=b.split(d).join(a[c]))}return b=b.replace(/#%[^\s]+#%/g,"")},L=function(){for(var a=0;a<y.length;a++)for(var b="_"+y[a]+"_HTML",c=r.length-1;c>=0;c--){var d=r[c][y[a]];if(void 0!=d){var e=d.split(".").join(" ").split(/[<.*>]/),f=!1;"<"==d.charAt(0)&&(f=!0);for(var g="",h=0,i=e.length;i>h;h++)g+=f?e[h]:new Array(e[h].length+3).join(" "),f=!f;g=g.toLowerCase(),r[c][b]=g}}},M=5;return{initialize:z,template:K}}();