!function(util,server,$){com_oracle_apex_flot_line=function(pRegionId,pOptions){function _create(tag){return $(document.createElement(tag))}function _init(pRegionId,pOptions){gChartOptions={series:{lines:{show:!0,interpolation:pOptions.interpolation,fill:pOptions.fill}},legend:{show:pOptions.showLegend},xaxis:{show:!0,mode:pOptions.isTimeData?"time":null,axisLabel:pOptions.xAxisTitle},yaxis:{axisLabel:pOptions.yAxisTitle,tickFormatter:_tickFormatter},grid:{hoverable:!0,clickable:!0,borderColor:"#d3d3d3",borderWidth:1},shadowSize:0},pOptions.showDataPoints&&(gChartOptions.points={show:"STEP"!=pOptions.interpolation,symbol:pOptions.dataPoints?pOptions.dataPoints.toLowerCase():"circle",radius:3}),pOptions.colors&&(gChartOptions.colors=pOptions.colors.split(",")),gOptions=pOptions,gRegion$=$("#"+util.escapeCSS(pRegionId),apex.gPageContext$),gChart$=$("#"+util.escapeCSS(pOptions.chartRegionId),apex.gPageContext$),gChart$.on("resize",_onResize).trigger("resize"),gPlot=$.plot(gChart$,[],gChartOptions),gChart$.on("resize",_fixLegend),gNoData$=_create("div").addClass("a-FlotLine-message").append(_create("div").addClass("a-FlotLine-messageIcon").append(_create("span").addClass("a-Icon icon-plugin-nodata"))).append(_create("span").addClass("a-FlotLine-messageText").text(gOptions.noDataFoundMessage)).hide(),gChart$.after(gNoData$),gOptions.showTooltip&&(gLabelTemplate='<div class="a-FlotLine-tooltip"><div>#inner#</div></div>',gTooltip$=$('<div id="'+util.escapeCSS(pRegionId)+'_tooltip" class="a-FlotLine-tooltip-container"></div>').appendTo(gChart$),gChart$.on("mousemove",_regionHover)),gChart$.on("plothover",_hover),gChart$.on("plotclick",_click),gRegion$.on("apexrefresh",_refresh).trigger("apexrefresh")}function _onResize(){gChart$.css("height",_recommendedHeight()+"px")}function _recommendedHeight(){var minAR=gOptions.minAR,maxAR=gOptions.maxAR,w=gChart$.width(),h=0===gChart$.height()?w/maxAR:gChart$.height(),ar=w/h;return minAR>ar?h=w/maxAR+1:ar>maxAR&&(h=w/minAR-1),Math.max(gOptions.minHeight,Math.min(gOptions.maxHeight,h))}function _click(pEvent,pPos,pObj){if(pObj){var trueIndex="STEP"==gOptions.interpolation?Math.ceil(pObj.dataIndex/2):pObj.dataIndex,dataPoint=gData[pObj.seriesIndex].data[trueIndex];dataPoint[3]&&window.location.assign(dataPoint[3])}}function _formatX(x){return gOptions.isTimeData?new Date(x).toUTCString():x.toString()}function _formatY(x){return(gOptions.valueTemplate||"#VALUE#").replace("#VALUE#",x)}function _tickFormatter(val,axis){return _formatY(val.toFixed(axis.tickDecimals))}function _renderTemplate(pObj){var result="",trueIndex="STEP"==gOptions.interpolation?Math.ceil(pObj.dataIndex/2):pObj.dataIndex,dataPoint=gData[pObj.seriesIndex].data[trueIndex];return gOptions.tooltipSeries&&(result+="<span><strong>"+pObj.series.label+"</strong></span>"),(gOptions.tooltipX||gOptions.tooltipY)&&(result+="<span>",gOptions.tooltipX&&(result+=util.escapeHTML(_formatX(dataPoint[0]))),gOptions.tooltipX&&gOptions.tooltipY&&(result+="<strong>&nbsp;&#124;&nbsp;</strong>"),gOptions.tooltipY&&(result+=util.escapeHTML(_formatY(dataPoint[1]))),result+="</span>"),gOptions.tooltipCustom&&dataPoint[2]&&(result+="<span>"+util.escapeHTML(dataPoint[2])+"</span>"),result}function _regionHover(e){hEvent=e.originalEvent}function _hover(pEvent,pPos,pObj){if(gHighlight&&(document.body.style.cursor="default",gPlot.unhighlight(gHighlight.series,gHighlight.datapoint),gHighlight=null,gOptions.showTooltip&&gTooltip$.hide()),pObj){"STEP"==gOptions.interpolation&&pObj.dataIndex%2==1&&(gPlot.unhighlight(pObj.series,pObj.datapoint),pObj={dataIndex:pObj.dataIndex+1,series:pObj.series,seriesIndex:pObj.seriesIndex,datapoint:pObj.series.data[(pObj.dataIndex+1)/2]});var trueIndex="STEP"==gOptions.interpolation?Math.ceil(pObj.dataIndex/2):pObj.dataIndex,dataPoint=gData[pObj.seriesIndex].data[trueIndex];dataPoint[3]&&(document.body.style.cursor="pointer"),gPlot.highlight(pObj.series,pObj.datapoint),gOptions.showTooltip&&(gTooltip$.show().position({my:"left+20 center",at:"right center",of:hEvent,within:gRegion$}).css({"border-color":pObj.series.color}),gHighlight!==pObj&&gTooltip$.html(gLabelTemplate.replace(/#inner#/,_renderTemplate(pObj)))),gHighlight=pObj}}function _draw(pData){var dataArray=pData.data,series={};if(dataArray.length>=1){gChart$.show(),gNoData$.hide();for(var i in dataArray)series[dataArray[i].series]||(series[dataArray[i].series]=[]),series[dataArray[i].series].push([dataArray[i].x,dataArray[i].y,dataArray[i].tooltip,dataArray[i].link]);var colorArray=pData.colors,colors={};for(var i in colorArray)colors[colorArray[i].series]||(colors[colorArray[i].series]=colorArray[i].color);var currentSeries,formattedSeries=[];for(var k in series)currentSeries={label:k,data:series[k]},colors[k]&&(currentSeries.color=colors[k]),formattedSeries.push(currentSeries);gData=formattedSeries,gPlot.setData(formattedSeries),gPlot.setupGrid(),gPlot.draw(),_fixLegend()}else gChart$.hide(),gNoData$.show()}function _fixLegend(){if(gOptions.showLegend){$(".legend>div",gChart$).remove();var table=$(".legend>table",gChart$);table.removeAttr("style"),$(".legendColorBox",table).each(function(i,element){var color=$("div>div",element).css("border-color");$(element).empty().append($("<div></div>").css("background-color",color))}),$(".legend",gChart$).hover(function(){$("table",$(this)).css("visibility","hidden")},function(){$("table",$(this)).css("visibility","visible")})}}function _clear(){}function _debug(){}function _refresh(){server.plugin(gOptions.ajaxIdentifier,{pageItems:gOptions.pageItems},{refreshObject:gRegion$,clear:_clear,success:_draw,error:_debug,loadingIndicator:gChart$,loadingIndicatorPosition:"append"})}var gOptions,gChartOptions,gRegion$,gChart$,gTooltip$,gNoData$,gData,gPlot,gHighlight,gLabelTemplate;_init(pRegionId,pOptions);var hEvent}}(apex.util,apex.server,apex.jQuery);